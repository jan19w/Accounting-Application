# ğŸ“‹ Project2 è®°è´¦æœ¬åº”ç”¨ - å®ç°æ€»ç»“

## âœ… å·²å®ŒæˆåŠŸèƒ½

### 1. åç«¯APIï¼ˆserver/server.jsï¼‰
å·²å®ç°å®Œæ•´çš„RESTful APIï¼š

| åŠŸèƒ½ | æ–¹æ³• | è·¯å¾„ | è¯´æ˜ |
|------|------|------|------|
| æŸ¥è¯¢æ‰€æœ‰è®°å½• | GET | `/api/details` | æŒ‰æ—¥æœŸé™åºè¿”å›æ‰€æœ‰è®°å½• |
| æ–°å¢è®°å½• | POST | `/api/details` | æ·»åŠ æ–°çš„è®°è´¦è®°å½• |
| æ›´æ–°è®°å½• | PUT | `/api/details/:id` | æ›´æ–°æŒ‡å®šIDçš„è®°å½• |
| åˆ é™¤è®°å½• | DELETE | `/api/details/:id` | åˆ é™¤æŒ‡å®šIDçš„è®°å½• |
| æ¸…ç©ºæ‰€æœ‰è®°å½• | DELETE | `/api/details` | åˆ é™¤æ•°æ®åº“ä¸­æ‰€æœ‰è®°å½• |

**ç‰¹æ€§ï¼š**
- âœ… å®Œæ•´çš„é”™è¯¯å¤„ç†
- âœ… å‚æ•°éªŒè¯
- âœ… CORSè·¨åŸŸæ”¯æŒ
- âœ… JSONæ ¼å¼å“åº”
- âœ… è¯¦ç»†çš„é”™è¯¯æ—¥å¿—

### 2. å‰ç«¯åº”ç”¨ï¼ˆsrc/App.jsxï¼‰
å·²å°†localStorageæ›¿æ¢ä¸ºæ•°æ®åº“APIè°ƒç”¨ï¼š

**æ ¸å¿ƒåŠŸèƒ½ï¼š**
- âœ… è‡ªåŠ¨åŠ è½½æ•°æ®åº“æ•°æ®
- âœ… æ–°å¢è®°å½•åˆ°æ•°æ®åº“
- âœ… ç¼–è¾‘å¹¶æ›´æ–°æ•°æ®åº“è®°å½•
- âœ… åˆ é™¤æ•°æ®åº“è®°å½•
- âœ… æ‰¹é‡æ¸…ç©ºæ•°æ®åº“
- âœ… åŠ è½½çŠ¶æ€æ˜¾ç¤º
- âœ… æ“ä½œæˆåŠŸ/å¤±è´¥æç¤º

**ä¿ç•™åŠŸèƒ½ï¼š**
- âœ… ç­›é€‰åŠŸèƒ½ï¼ˆç±»å‹ã€æ—¥æœŸã€ç±»åˆ«ã€å…³é”®è¯ï¼‰
- âœ… KPIç»Ÿè®¡å¡ç‰‡ï¼ˆæ€»æ”¶å…¥ã€æ€»æ”¯å‡ºã€å‡€æ”¶æ”¯ï¼‰
- âœ… å›¾è¡¨å±•ç¤ºï¼ˆé¥¼å›¾ã€æŸ±çŠ¶å›¾ï¼‰
- âœ… åˆ†é¡µæ˜¾ç¤º
- âœ… å“åº”å¼è®¾è®¡

### 3. æ•°æ®åº“é…ç½®

**æ•°æ®åº“ç»“æ„ï¼š**
```sql
æ•°æ®åº“åï¼šprojectdata
è¡¨åï¼šdetails

å­—æ®µï¼š
- id (VARCHAR(50), ä¸»é”®)
- type (ENUM: income/expense)
- category (VARCHAR(50))
- amount (DECIMAL(10,2))
- date (DATE)
- note (TEXT)
- created_at (TIMESTAMP)
- updated_at (TIMESTAMP)
```

**ç´¢å¼•ä¼˜åŒ–ï¼š**
- æ—¥æœŸç´¢å¼• (idx_date)
- ç±»å‹ç´¢å¼• (idx_type)
- ç±»åˆ«ç´¢å¼• (idx_category)

### 4. æ–‡æ¡£å®Œå–„

å·²åˆ›å»ºçš„æ–‡æ¡£ï¼š
1. âœ… `server/init.sql` - æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬
2. âœ… `README_DATABASE.md` - å®Œæ•´çš„æ•°æ®åº“é…ç½®æ–‡æ¡£
3. âœ… `QUICK_START.md` - å¿«é€Ÿå¯åŠ¨æŒ‡å—
4. âœ… `server/test-api.http` - APIæµ‹è¯•æ–‡ä»¶

## ğŸ”„ ä¸»è¦æ”¹åŠ¨

### å‰ç«¯æ”¹åŠ¨ï¼ˆsrc/App.jsxï¼‰

**åˆ é™¤ï¼š**
```javascript
import { loadTx, saveTx, clearTx } from './utils/storage.js';
const [list, setList] = useState(() => loadTx());
```

**æ–°å¢ï¼š**
```javascript
const API_BASE = 'http://localhost:5000/api/details';
const [list, setList] = useState([]);
const [loading, setLoading] = useState(true);

useEffect(() => {
  fetchData();
}, []);

async function fetchData() { /* ä»APIè·å–æ•°æ® */ }
async function addOrUpdate(item) { /* APIæ–°å¢/æ›´æ–° */ }
async function remove(id) { /* APIåˆ é™¤ */ }
async function wipeAll() { /* APIæ‰¹é‡åˆ é™¤ */ }
```

### åç«¯æ”¹åŠ¨ï¼ˆserver/server.jsï¼‰

**æ–°å¢APIæ¥å£ï¼š**
- POST `/api/details` - æ–°å¢
- PUT `/api/details/:id` - æ›´æ–°
- DELETE `/api/details/:id` - åˆ é™¤å•æ¡
- DELETE `/api/details` - åˆ é™¤æ‰€æœ‰

**æ”¹è¿›ï¼š**
- å¢å¼ºçš„é”™è¯¯å¤„ç†
- è¯·æ±‚å‚æ•°éªŒè¯
- è¯¦ç»†çš„å“åº”æ¶ˆæ¯

## ğŸ“¦ é¡¹ç›®ç»“æ„

```
project2/react-bookkeeper/
â”œâ”€â”€ server/
â”‚   â”œâ”€â”€ server.js           # åç«¯æœåŠ¡å™¨ï¼ˆå·²å®Œå–„CRUDï¼‰
â”‚   â”œâ”€â”€ init.sql            # æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬ï¼ˆæ–°å¢ï¼‰
â”‚   â”œâ”€â”€ test-api.http       # APIæµ‹è¯•æ–‡ä»¶ï¼ˆæ–°å¢ï¼‰
â”‚   â””â”€â”€ package.json        # åç«¯ä¾èµ–ï¼ˆå·²æ›´æ–°ï¼‰
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ App.jsx             # ä¸»åº”ç”¨ï¼ˆå·²æ”¹ä¸ºAPIè°ƒç”¨ï¼‰
â”‚   â”œâ”€â”€ components/         # Reactç»„ä»¶ï¼ˆä¿æŒä¸å˜ï¼‰
â”‚   â””â”€â”€ utils/
â”‚       â”œâ”€â”€ storage.js      # localStorageå·¥å…·ï¼ˆä¸å†ä½¿ç”¨ï¼‰
â”‚       â””â”€â”€ categories.js   # ç±»åˆ«é…ç½®ï¼ˆä¿æŒä¸å˜ï¼‰
â”œâ”€â”€ README_DATABASE.md      # æ•°æ®åº“æ–‡æ¡£ï¼ˆæ–°å¢ï¼‰
â”œâ”€â”€ QUICK_START.md          # å¿«é€Ÿå¯åŠ¨ï¼ˆæ–°å¢ï¼‰
â”œâ”€â”€ å®ç°æ€»ç»“.md             # æœ¬æ–‡ä»¶ï¼ˆæ–°å¢ï¼‰
â””â”€â”€ package.json            # å‰ç«¯ä¾èµ–
```

## ğŸš€ å¯åŠ¨æ­¥éª¤

### 1. åˆå§‹åŒ–æ•°æ®åº“
```bash
mysql -u root -p < server/init.sql
```

### 2. å¯åŠ¨åç«¯
```bash
cd server
npm start
```

### 3. å¯åŠ¨å‰ç«¯
```bash
npm start
```

### 4. è®¿é—®åº”ç”¨
æ‰“å¼€æµè§ˆå™¨è®¿é—®ï¼šhttp://localhost:3000

## ğŸ¯ æŠ€æœ¯æ ˆ

### åç«¯
- Node.js + Express
- MySQL (mysql2)
- CORS

### å‰ç«¯
- React 19.2
- ECharts å›¾è¡¨åº“
- Fetch API

## ğŸ“ æ³¨æ„äº‹é¡¹

1. **æ•°æ®è¿ç§»**ï¼šåŸlocalStorageæ•°æ®ä¸ä¼šè‡ªåŠ¨è¿ç§»åˆ°æ•°æ®åº“ï¼Œéœ€è¦æ‰‹åŠ¨é‡æ–°å½•å…¥
2. **æ•°æ®åº“é…ç½®**ï¼šç¡®ä¿server.jsä¸­çš„MySQLè´¦å·å¯†ç æ­£ç¡®
3. **ç«¯å£é…ç½®**ï¼šåç«¯5000ï¼Œå‰ç«¯3000ï¼Œç¡®ä¿ç«¯å£æœªè¢«å ç”¨
4. **MySQLç‰ˆæœ¬**ï¼šå»ºè®®ä½¿ç”¨MySQL 5.7+æˆ–8.0+

## âœ¨ æœªæ¥å¯èƒ½çš„æ”¹è¿›

- [ ] æ•°æ®å¯¼å…¥/å¯¼å‡ºåŠŸèƒ½
- [ ] ç”¨æˆ·è®¤è¯å’Œå¤šç”¨æˆ·æ”¯æŒ
- [ ] æ•°æ®å¤‡ä»½å’Œæ¢å¤
- [ ] æ›´å¤šçš„ç»Ÿè®¡å›¾è¡¨
- [ ] ç§»åŠ¨ç«¯é€‚é…ä¼˜åŒ–
- [ ] é¢„ç®—è®¾ç½®å’Œæé†’
- [ ] åˆ†ç±»ç®¡ç†

## ğŸ‰ æ€»ç»“

å·²æˆåŠŸå°†project2çš„è®°è´¦æœ¬åº”ç”¨ä»localStorageæ”¹é€ ä¸ºå®Œæ•´çš„MySQLæ•°æ®åº“æ–¹æ¡ˆï¼Œå®ç°äº†ï¼š
- âœ… å®Œæ•´çš„å‰åç«¯åˆ†ç¦»æ¶æ„
- âœ… RESTful APIè®¾è®¡
- âœ… æ•°æ®æŒä¹…åŒ–å­˜å‚¨
- âœ… å®Œå–„çš„é”™è¯¯å¤„ç†
- âœ… è¯¦ç»†çš„æ–‡æ¡£è¯´æ˜

é¡¹ç›®ç°åœ¨å¯ä»¥æŠ•å…¥ä½¿ç”¨ï¼Œæ•°æ®å®‰å…¨æ€§å’Œå¯é æ€§å¤§å¹…æå‡ï¼


